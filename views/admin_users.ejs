<section class="grid-2">
  <% admins = Array.isArray(admins) ? admins : []; %>
  <% currentEmail = typeof currentEmail === 'string' ? currentEmail : '' ; %>
  <div>
    <h2>Admins</h2>
    <% if (message) { %>
      <p class="muted <%= message.type==='error' ? 'msg-error' : 'msg-info' %>"><%= message.text %></p>
    <% } %>
    <% if (!admins || admins.length === 0) { %>
      <p class="muted">No admin accounts yet.</p>
    <% } else { %>
      <ul class="list">
        <% admins.forEach(function(a){ %>
          <li class="list-item">
            <div>
              <strong><%= a.email %></strong>
              <% if (a.email === currentEmail) { %>
                <span class="badge" style="margin-left:8px;">You</span>
              <% } %>
            </div>
            <div class="actions">
              <form action="/admin/admins/<%= a.email %>/delete" method="post">
                <button class="btn small" type="submit" <%= a.email===currentEmail?'disabled':'' %>>Remove</button>
              </form>
            </div>
          </li>
        <% }); %>
      </ul>
    <% } %>
  </div>
  <div>
    <h2>Add Admin</h2>
    <p class="muted">Max admins: <strong><%= adminMax %></strong></p>
    <form action="/admin/admins/add" method="post" class="form-grid">
      <label>Admin Email</label>
      <input type="email" name="email" required placeholder="admin@company.com" />
      <button class="btn" type="submit">Add Admin</button>
    </form>
    <p class="muted" style="margin-top:8px;">New admin must log in using the same email via Firebase or Signup to activate access.</p>
    <div class="card" style="margin-top:16px;">
      <h3>Danger Zone</h3>
      <p class="muted">Clear all memos and users. Keeps the current admin account. Purges uploads.</p>
      <form action="/admin/reset" method="post" onsubmit="return confirm('Are you sure? This will delete ALL memos and users and purge uploads. The current admin will be retained.');">
        <button class="btn" type="submit" style="background:#d83a3a;">Reset Data</button>
      </form>
    </div>
    <div class="card" style="margin-top:16px;">
      <h3>Danger Zone (Full Wipe)</h3>
      <p class="muted">Delete ALL users and memos, purge uploads, and log you out.</p>
      <form action="/admin/reset-all" method="post" onsubmit="return confirm('This will wipe ALL users and memos, purge uploads, and log you out. Continue?');">
        <button class="btn" type="submit" style="background:#d83a3a;">Reset All Data</button>
      </form>
    </div>
  </div>
</section>
